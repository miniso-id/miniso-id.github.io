<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Search</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>

<h2>ğŸ” Cari Produk</h2>

<input id="search" placeholder="Scan barcode / ketik nama">
<button onclick="startScan()">ğŸ“· Scan Barcode</button>

<div id="reader"></div>
<div id="result"></div>

<script>
let products = [];

fetch('products.json')
  .then(res => res.json())
  .then(data => products = data);

document.getElementById('search').addEventListener('input', e => {
  showResult(e.target.value);
});

function showResult(q) {
  q = q.toLowerCase();
  const found = products.filter(p =>
    p.barcode.includes(q) || p.name.toLowerCase().includes(q)
  );

  document.getElementById('result').innerHTML =
    found.map(p => `
      <div class="card">
        <img src="${p.image}" loading="lazy">
        <div>
          <b>${p.name}</b><br>
          <small>${p.barcode}</small>
        </div>
      </div>
    `).join('');
}

function startScan() {
  const reader = new Html5Qrcode("reader");
  reader.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    code => {
      document.getElementById('search').value = code;
      showResult(code);
      reader.stop();
    }
  );
}
</script>

</body>
</html>
